<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Business Document Creator</title>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    .container { background: #fff; padding: 20px; border-radius: 10px; width: 900px; margin: auto; }
    h2 { margin-top: 40px; }
    button { padding: 10px 15px; margin: 5px; cursor: pointer; }
    input, textarea, select { width: 100%; padding: 8px; margin: 5px 0 15px; }
    #logoPreview { max-height: 100px; margin-top: 10px; display: block; }
    .doc-box { border: 1px solid #ccc; padding: 15px; border-radius: 7px; background: #fafafa; }
</style>
</head>

<body>
<div class="container">

<h1>Business Document Generator</h1>

<!-- Logo Upload -->
<h2>Company Logo</h2>
<input type="file" id="logoUpload" accept="image/*">
<img id="logoPreview">

<!-- Personal Template Settings -->
<h2>Personal Template Settings</h2>
<input type="text" id="companyName" placeholder="Company Name">
<input type="text" id="companyAddress" placeholder="Company Address">
<input type="text" id="companyPhone" placeholder="Company Phone Number">
<button onclick="saveTemplate()">Save Template</button>
<button onclick="loadTemplate()">Load Template</button>

<hr>

<!-- MAIN DOCUMENT FORM -->
<h2>Create Document</h2>

<label>Select Document Type:</label>
<select id="docType">
    <option value="Quotation">Quotation</option>
    <option value="Invoice">Invoice</option>
    <option value="Receipt">Receipt</option>
    <option value="PO">Purchase Order (PO)</option>
    <option value="DO">Delivery Order (DO)</option>
</select>

<label>Date:</label>
<input type="date" id="docDate">

<label>Customer Name:</label>
<input type="text" id="customerName">

<label>Item Description:</label>
<textarea id="itemDesc"></textarea>

<label>Amount (RM):</label>
<input type="number" id="amount">

<button onclick="generateDocument()">Generate Document</button>

<!-- OUTPUT AREA -->
<h2>Generated Document</h2>
<div id="output" class="doc-box"></div>

<button onclick="printDocument()">Print / Send</button>
<button onclick="downloadPDF()">Save as PDF</button>

</div>

<script>
// AUTO FILL TODAY DATE
document.getElementById("docDate").value = new Date().toISOString().split("T")[0];

// LOGO UPLOAD PREVIEW
document.getElementById("logoUpload").addEventListener("change", function(){
    const file = this.files[0];
    document.getElementById("logoPreview").src = URL.createObjectURL(file);
});

// SAVE TEMPLATE
function saveTemplate() {
    const template = {
        name: document.getElementById("companyName").value,
        addr: document.getElementById("companyAddress").value,
        phone: document.getElementById("companyPhone").value
    };
    localStorage.setItem("template", JSON.stringify(template));
    alert("Template saved!");
}

// LOAD TEMPLATE
function loadTemplate() {
    const data = JSON.parse(localStorage.getItem("template"));
    if (data) {
        document.getElementById("companyName").value = data.name;
        document.getElementById("companyAddress").value = data.addr;
        document.getElementById("companyPhone").value = data.phone;
    } else {
        alert("No template found!");
    }
}

// GENERATE DOCUMENT
function generateDocument() {
    const logo = document.getElementById("logoPreview").src;
    const type = document.getElementById("docType").value;
    const date = document.getElementById("docDate").value;
    const cust = document.getElementById("customerName").value;
    const desc = document.getElementById("itemDesc").value;
    const amt = document.getElementById("amount").value;

    document.getElementById("output").innerHTML = `
        <img src="${logo}" style="max-height:80px;"><br><br>
        <b>${document.getElementById("companyName").value}</b><br>
        ${document.getElementById("companyAddress").value}<br>
        ${document.getElementById("companyPhone").value}<br><br>

        <h2>${type}</h2>
        <b>Date:</b> ${date}<br>
        <b>Customer:</b> ${cust}<br><br>

        <b>Description:</b><br>
        ${desc}<br><br>

        <b>Amount:</b> RM ${amt}<br><br>

        <hr>
        <i>This is a system-generated ${type}.</i>
    `;
}

// PRINT DOCUMENT
function printDocument() {
    const content = document.getElementById("output").innerHTML;
    const printWindow = window.open("", "", "width=900,height=650");
    printWindow.document.write(content);
    printWindow.document.close();
    printWindow.print();
}

// SAVE AS PDF
function downloadPDF() {
    const element = document.getElementById("output");
    const opt = {
        margin: 10,
        filename: "document.pdf",
        html2canvas: { scale: 2 },
        jsPDF: { unit: "mm", format: "a4", orientation: "portrait" }
    };
    html2pdf().from(element).set(opt).save();
}
</script>

<!-- PDF LIBRARY -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

</body>
</html>
